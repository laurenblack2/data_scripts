import pandas as pd
import numpy as np

studyi = 'study_identifier.csv'
study = 'study1.csv'
core = 'core1.csv'

df = pd.read_csv(studyi, low_memory = False)

'''
lookup_fsid = ['00111-01-001','00247-01-001','00333-01-001','00352-01-001','00420-01-001','00468-01-001','00473-01-001','00479-05-021','00479-07-010','00479-07-011','00518-01-001','00634-01-001','00738-01-001','00859-01-001','01113-01-001','01151-01-001','01152-01-001','01178-01-001','01950-01-001','02023-01-001','02123-01-001','02303-01-001','02331-01-001','02604-01-001','02608-01-001','02663-01-001','02706-01-001','02718-01-001','02727-01-001','02758-01-001','02856-01-001','02881-01-001','02906-01-001','03078-01-001','03250-01-001','03370-01-001','04050-01-001','04197-01-001','04219-01-001','04220-01-001','04289-01-001','04297-01-001','04298-01-001','08040-01-001','08040-01-002','08040-02-001','08040-02-002','08041-01-001','08041-02-001','08041-02-002','08042-01-001','08042-02-001','08042-02-002','08045-01-001','08045-02-001','08045-02-002','08047-01-001','08047-02-001','08047-02-002','08058-02-001','08058-02-002','08059-01-001','08059-02-001','08059-02-002','08062-01-001','08062-02-001','08062-02-002','08101-01-001','08101-01-002','08101-02-001','08101-02-002','08104-01-001','08104-02-001','08104-02-002','08105-01-001','08105-02-001','08105-02-002','08107-01-001','08107-02-001','08107-02-002','08108-01-001','08108-02-001','08108-02-002','08109-01-001','08109-02-001','08109-02-002','08110-01-001','08110-02-001','08110-02-002','08112-01-001','08112-02-001','08112-02-002','08113-01-001','08113-02-001','08113-02-002','08114-01-001','08114-02-001','08114-02-002','08115-01-001','08115-02-001','08115-02-002','08116-01-001','08116-01-002','08116-01-003','08116-02-001','08116-02-002','08116-04-001','08116-04-002','08116-04-003','08116-04-004','08118-01-001','08119-01-001','08119-02-001','08119-02-002','08120-01-001','08120-02-001','08120-02-002','08123-01-001','08123-02-001','08123-02-002','08124-01-001','08124-02-002','08126-01-001','08126-02-001','08126-02-002','08128-01-001','08128-02-001','08128-02-002','08129-01-001','08129-02-001','08129-02-002','08130-01-001','08130-02-001','08130-02-002','08131-01-001','08131-02-002','08132-01-001','08132-02-001','08132-02-002','08133-01-001','08133-01-002','08133-02-001','08133-02-002','08134-01-001','08134-04-003','08134-04-004','08135-01-001','08135-02-001','08135-02-002','08136-01-001','08138-01-001','08138-02-001','08138-02-002','08139-01-001','08139-02-001','08139-02-002','08141-01-001','08141-02-001','08141-02-002','08142-01-001','08142-02-002','08143-01-001','08143-02-001','08143-02-002','08144-01-001','08144-02-001','08144-02-002','08145-01-001','08145-02-001','08145-02-002','08146-01-001','08146-02-001','08146-02-002','08147-01-001','08147-02-001','08147-02-002','08148-01-001','08148-02-001','08148-02-002','08149-01-001','08149-02-001','08149-02-002','08150-01-001','08150-02-001','08150-02-002','08151-01-001','08151-01-002','08151-01-003','08151-02-001','08151-02-002','08152-01-001','08152-02-002','08153-01-001','08153-01-002','08153-01-003','08153-02-001','08153-02-002','08154-01-001','08154-02-001','08154-02-002','08156-01-001','08156-02-001','08156-02-002','08157-01-001','08157-02-001','08157-02-002','08158-01-001','08158-02-001','08158-02-002','08159-01-001','08159-02-001','08159-02-002','08160-01-001','08160-01-002','08160-01-003','08160-02-002','08161-01-001','08161-02-001','08161-02-002','08162-01-001','08162-02-001','08162-02-002','08165-01-001','08165-02-001','08165-02-002','08167-01-001','08168-01-001','08168-02-001','08168-02-002','08169-01-001','08169-02-001','08169-02-002','08170-01-001','08170-02-001','08170-02-002','08177-02-002','08181-01-001','08181-02-001','08181-02-002','08182-01-001','08182-02-001','08182-02-002','08187-01-001','80301-01-001']
df_filtered = df.loc[df['fsid'].isin(lookup_fsid)]
df_filtered.to_csv('test.csv', index = False)
'''
df = df.astype(str)

df['family_id'] = np.where(
    df['fam_id'].str.len() < 5, df['fam_id'].str.zfill(5),""
)
df = df.drop(['fam_id'], axis=1)

df['site_code'] = np.where(
    df['study_identifier'].str.len() < 3, df['study_identifier'].str.zfill(3),""
)
df = df.drop(['study_identifier'], axis=1)

#list1 = [1,4,5,6,7,8,9,10,11,14,15,17,18,21,22,25,26,27,28,30,31,34,35,36,37,38,39,40,41,42,43,45,47,48,50,51,52,53,55,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,94,95,99,100,101,103,104,105,106,107,998,999,111,112,114,115,116,137,136,135,139]
#df = df[df.study_identifier1.isin(list1) == False]

df['site_name'] = np.where(
    df['study_identifier1'].str.len() < 3, df['study_identifier1'].str.zfill(3),""
)
df = df.drop(['study_identifier1'], axis=1)
#print(df.dtypes)
lookup_fam = ['03004']
df_filtered = df.loc[df['family_id'].isin(lookup_fam)]

df_reorder = df_filtered[['family_id','site_code','study_identifier1']]
#df.rename(columns={'study_identifier1': 'site_name'}, inplace=True)

df_reorder.to_csv('study_ids_lookup.csv', index = False)
#df_filtered.to_csv('fcore_02c0211.csv', index = False)